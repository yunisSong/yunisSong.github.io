---
layout:     post
title:      Python编程快速上手 — 让繁琐工作自动化
subtitle:   在不断填坑中前进。。
date:       2017-10-12
author:     三十一
header-img: img/in-post/post-Python.jpeg
header-mask: 0.3
catalog:    true
tags:
   - Python
---

# Python编程快速上手 — 让繁琐工作自动化
### 基础概念
#### 导入模块

```Python
import string
import random,sys,os


```

```
from random import *
```
使用这种形式的 import 语句，调用 random 模块中的函数时不需要 random.前缀。 但是，使用完整的名称会让代码更可读，所以最好是使用普通形式的 import 语句。


#### 声明函数
##### 不带参数

```
def Hello():
    print("----hello world.----")

Hello()
```

##### 带有参数
>输出中文需要在开头加入`# -*- coding: UTF-8 -*-` 或者 `#coding=utf-8`

```
def Hello(name):
    print("----hello world.----" + name)

Hello("Yunis")
Hello("三十一")
```

##### 带有多个参数

```
def Hello(name,age):
    print( name + " is " + str(age) + " years old this year")

Hello("Yunis",18)
Hello("三十一",25)
```

#### 关键字参数 和 `print()`


```
  print('Hello')  print('World')
```

输出为：

```
Hello 
World
```

这是因为 `print()`函数自动在传入的字符串末尾 添加了换行符。
可以通过 end 关键字参数，设置这个末尾。


```
print('Hello', end='')print('World')
```

输出为：

```
HelloWorld
```

类似地，如果向 print()传入多个字符串值,该函数就会自动用一个空格分隔它们。

```
>>> print('cats', 'dogs', 'mice') 
>>> cats dogs mice
```

可以传入 `sep` 关键字参数，替换掉默认的分隔字符.

```
>>> print('cats', 'dogs', 'mice', sep=',')
>>> cats,dogs,mice
```

#### 作用域

* 全局作用域中的代码不能使用任何局部变量;* 但是，局部作用域可以访问全局变量;* 一个函数的局部作用域中的代码，不能使用其他局部作用域中的变量。* 如果在不同的作用域中，你可以用相同的名字命名不同的变量。也就是说，可以有一个名为 spam 的局部变量，和一个名为 spam 的全局变量。

如果需要在一个函数内修改全局变量，就使用 global 语句。

```Python
def spam():    global eggs    eggs = 'spam'      
eggs = 'global'spam()print(eggs)//spam
```

1. 如果变量在全局作用域中使用(即在所有函数之外)，它就总是全局变量。 
2. 如果在一个函数中，有针对该变量的 global 语句，它就是全局变量。 
3. 否则，如果该变量用于函数中的赋值语句，它就是局部变量。 
4. 但是，如果该变量没有用在赋值语句中，它就是全局变量。


#### 异常处理
错误可以由 try 和 except 语句来处理。那些可能出错的语句被放在 try 子句中。 如果错误发生，程序执行就转到接下来的 except 子句开始处。

```Python
def spam(divideBy):    try:        return 42 / divideBy 
    except ZeroDivisionError:        print('Error: Invalid argument.')
        print(spam(2))print(spam(12))print(spam(1))

#Error: Invalid argument. 
#Noneprint(spam(0))
```

#### 列表

##### 下标取值
```
spam = ['cat', 'bat','dog']
print(spam[0])  #cat
print(spam[-1]) #dog
```

|| cat | bat | dog |
|---| --- | --- | --- |
|正向| 0 | 1 | 2 |
|负向| -3 | -2 | -1 |


##### 切片获取子列表

```
spam = ['cat', 'bat','dog']

print(spam[:-1])  #['cat', 'bat']
print(spam[0:-1]) #['cat', 'bat']
print(spam[0:1])  #['cat']
print(spam[:1])   #['cat']
print(spam[0:2])  #['cat', 'bat']
print(spam[0:3])  #['cat', 'bat', 'dog']
```

##### 列表链接、复制
`+` 操作符可以连接两个列表，得到一个新列表。

```
spam = ['cat', 'bat','dog'] + [1,2,3]
print(spam)  #['cat', 'bat', 'dog', 1, 2, 3]
```
##### 多重赋值技巧


```
spam = ['cat', 'bat','dog']
x,y,z = spam
print(x)  #cat
print(y)  #bat
print(z)  #dog
```


##### 元组 、字符串 、列表  转换


```
>>> tuple(['cat', 'dog', 5]) 
 ('cat', 'dog', 5)>>> list(('cat', 'dog', 5)) 
 ['cat', 'dog', 5]>>> list('hello')['h', 'e', 'l', 'l', 'o']
```

### 自动化任务


#### 正则表达式
Python 中所有正则表达式的函数都在 re 模块中。

* `?` 匹配0次或者一次
* `*` 匹配0次或者多次
* `+` 匹配1次或者多次
* {n}匹配 n 次前面的分组。* {n,}匹配 n 次或更多前面的分组。* {,m}匹配零次到 m 次前面的分组。* {n,m}匹配至少 n 次、至多 m 次前面的分组。* `{n,m}?`或`*?`或`+?`对前面的分组进行非贪心匹配。* `^spam` 意味着字符串必须以 spam 开始。* `spam$`意味着字符串必须以 spam 结束。* .匹配所有字符，换行符除外。* `\d`、`\w` 和`\s` 分别匹配数字、单词和空格。* `\D`、`\W `和`\S` 分别匹配出数字、单词和空格外的所有字符。* `[abc]`匹配方括号内的任意字符(诸如 a、b 或 c)。* `[^abc]`匹配不在方括号内的任意字符。
##### 用 `sub()`方法替换字符串


```Python
>>> namesRegex = re.compile(r'Agent \w+')>>> namesRegex.sub('CENSORED', 'Agent Alice gave the secret documents to Agent Bob.') 

'CENSORED gave the secret documents to CENSORED.'
```

有时候，你可能需要使用匹配的文本本身，作为替换的一部分。在 sub()的第一 个参数中，可以输入\1、\2、\3......。表示“在替换中输入分组 1、2、3......的文本”。

```>>> agentNamesRegex = re.compile(r'Agent (\w)\w*')>>> agentNamesRegex.sub(r'\1****', 'Agent Alice told Agent Carol that Agent Eve knew Agent Bob was a double agent.')
A**** told C**** that E**** knew B**** was a double agent.'
```

#### 读写文件
##### 文件及文件路径
* 相对路径：相对于程序的当前工作目录。
* 绝对路径：总是从根文件开始。

`os.makedirs()` 创建文件夹

* 调用 os.path.abspath(path)将返回参数的绝对路径的字符串。这是将相对路径转 换为绝对路径的简便方法。* 调用 os.path.isabs(path)，如果参数是一个绝对路径，就返回 True，如果参数是 一个相对路径，就返回 False。* 调用 os.path.relpath(path, start)将返回从 start 路径到 path 的相对路径的字符串。 如果没有提供 start，就使用当前工作目录作为开始路径。
* 调用 os.path.getsize(path)将返回 path 参数中文件的字节数。
* 调用 os.listdir(path)将返回文件名字符串的列表，包含 path 参数中的每个文件 (请注意，这个函数在 os 模块中，而不是 os.path)。
* 检查路径有效性
    * 如果 path 参数所指的文件或文件夹存在，调用 os.path.exists(path)将返回 True， 否则返回 False
    * 如果 path 参数存在，并且是一个文件，调用 os.path.isfile(path)将返回 True，否 则返回 False
    * 如果 path 参数存在，并且是一个文件夹，调用 os.path.isdir(path)将返回 True， 否则返回 False。


===
在 Python 中，读写文件有 3 个步骤:
1. 调用 `open()` 函数，返回一个 File 对象。
2. 调用 File 对象的 `read()`或 `write()`方法。 
3. 调用 File 对象的` close()`方法，关闭该文件。


```
helloFile = open('/Users/your_home_folder/hello.txt')

读文件
helloContent = helloFile.read()

写文件
baconFile = open('bacon.txt', 'w')
baconFile.write('Hello world!\n')
baconFile.close()




```


##### 生成随机试卷及答案

1. 创建35个试卷文件及对应的答案文件。
2. 为每一个试卷随机生成50道题目，次序随机。
3. 为每一个问题提供一个正确答案和三个错误答案，次序随机。
4. 将测试题目写入试卷文件，将对应的答案写入相应的答案文件中。

```
# -*- coding: UTF-8 -*-
import random
import os

# 进入工作目录
os.chdir('/Users/Yunis/Desktop/学习/Python/random')
# 打印当前工作目录
print("当前工作目录为 %s"%(os.getcwd()))

# 首都以及首都集合字典 习题集及答案
capitals = {'Alabama': 'Montgomery', 'Alaska': 'Juneau', 'Arizona': 'Phoenix','Arkansas': 'Little Rock', 'California': 'Sacramento', 'Colorado': 'Denver', 'Connecticut': 'Hartford', 'Delaware': 'Dover', 'Florida': 'Tallahassee', 'Georgia': 'Atlanta', 'Hawaii': 'Honolulu', 'Idaho': 'Boise', 'Illinois': 'Springfield', 'Indiana': 'Indianapolis', 'Iowa': 'Des Moines', 'Kansas': 'Topeka', 'Kentucky': 'Frankfort', 'Louisiana': 'Baton Rouge', 'Maine': 'Augusta', 'Maryland': 'Annapolis', 'Massachusetts': 'Boston', 'Michigan': 'Lansing', 'Minnesota': 'Saint Paul', 'Mississippi': 'Jackson', 'Missouri': 'Jefferson City', 'Montana': 'Helena', 'Nebraska': 'Lincoln', 'Nevada': 'Carson City', 'New Hampshire': 'Concord', 'New Jersey': 'Trenton', 'New Mexico': 'Santa Fe', 'New York': 'Albany', 'North Carolina': 'Raleigh',
'North Dakota': 'Bismarck', 'Ohio': 'Columbus', 'Oklahoma': 'Oklahoma City', 'Oregon': 'Salem', 'Pennsylvania': 'Harrisburg', 'Rhode Island': 'Providence', 'South Carolina': 'Columbia', 'South Dakota': 'Pierre', 'Tennessee': 'Nashville', 'Texas': 'Austin', 'Utah': 'Salt Lake City', 'Vermont': 'Montpelier', 'Virginia': 'Richmond', 'Washington': 'Olympia', 'West Virginia': 'Charleston', 'Wisconsin': 'Madison', 'Wyoming': 'Cheyenne'}

# 循环35次 因为要出35分试卷
for quizNum in range(35):
    quizFile = open('capitalsquiz%s.txt' % (quizNum + 1), 'w')
    answerKeyFile = open('capitalsquiz_answers%s.txt' % (quizNum + 1), 'w')
    quizFile.write('Name:\n\nDate:\n\nPeriod:\n\n')
    quizFile.write((' ' * 20) + 'State Capitals Quiz (Form %s)' % (quizNum + 1))
    quizFile.write('\n\n')
    # 获取字典 keys
    states = list(capitals.keys())
    # 用于将一个列表中的元素打乱。
    random.shuffle(states)

    # 每份试卷有50道题目
    for questionNum in range(50):
        # Get right and wrong answers.
        correctAnswer = capitals[states[questionNum]]
        # 获取答案列表
        wrongAnswers = list(capitals.values())
        # 删除正确的答案选项
        del wrongAnswers[wrongAnswers.index(correctAnswer)]
        # 从错误的答案选项随机选出3个错误的答案
        wrongAnswers = random.sample(wrongAnswers, 3)
        # 给当前题目设置答案集合
        answerOptions = wrongAnswers + [correctAnswer]
        # 打乱 答案顺序
        random.shuffle(answerOptions)
        # 在试卷文件 写入 题号 以及题目
        quizFile.write('%s. What is the capital of %s?\n' % (questionNum + 1,states[questionNum]))
        # 在试卷文件 写入答案选项
        for i in range(4):
            quizFile.write(' %s. %s\n' % ('ABCD'[i], answerOptions[i]))
        quizFile.write('\n')
        # 把正确答案的题号以及正确答案写入答案文件
        answerKeyFile.write('%s. %s\n' % (questionNum + 1, 'ABCD'[
        answerOptions.index(correctAnswer)]))

    # 关闭试卷文件
    quizFile.close()
    # 关闭答案文件
    answerKeyFile.close()

```


