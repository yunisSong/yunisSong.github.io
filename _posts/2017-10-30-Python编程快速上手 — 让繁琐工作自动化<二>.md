---
layout:     post
title:      Python编程快速上手 — 让繁琐工作自动化<二>
subtitle:   在不断填坑中前进。。
date:       2017-10-30
author:     三十一
header-img: img/post-bg-nextgen-web-pwa.jpg
header-mask: 0.3
catalog:    true
tags:
   - Python
---

# Python编程快速上手 — 让繁琐工作自动化

### 处理`Excel`表格

使用 `openpyxl.load_workbook()` 打开文件。


```
wb = openpyxl.load_workbook('python.xlsx')

# 获取所有表名的列表
wb.get_sheet_names()
# 根据名字获取列表
sheet = wb.get_sheet_by_name('Yunis000')

# A1 单元格
c = sheet['A1']

# B10 单元格
c2 = sheet.cell(row=10, column=2)
```

#### 从表中取得行和列

可以将 Worksheet 对象切片，取得电子表格中一行、一列或一个矩形区域中的所有 Cell 对象。然后可以循环遍历这个切片中的所有单元格



```
print(tuple(sheet['A1':'C3'])) #((<Cell 'Yunis000'.A1>, <Cell 'Yunis000'.B1>, <Cell 'Yunis000'.C1>), (<Cell 'Yunis000'.A2>, <Cell 'Yunis000'.B2>, <Cell 'Yunis000'.C2>), (<Cell 'Yunis000'.A3>, <Cell 'Yunis000'.B3>, <Cell 'Yunis000'.C3>))



for rowOfCellObjects in sheet['A1':'C3']:
    for cellObj in rowOfCellObjects:
        print(cellObj.coordinate, cellObj.value)
    print('--- END OF ROW ---')

# A1 111111111
# B1 None
# C1 None
# --- END OF ROW ---
# A2 None
# B2 None
# C2 None
# --- END OF ROW ---
# A3 None
# B3 None
# C3 None
# --- END OF ROW ---
```

`cellObj.coordinate` cell 坐标
`cellObj.value` cell 值


